<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Account - User Management</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/nav.css">
    <link rel="stylesheet" href="../css/account.css">
</head>

<body>
    <div class="dashboard-container d-flex">
        <aside id="sidebar" class="sidebar d-flex flex-column align-items-center py-3">
            <button id="burgerBtn" class="btn btn-outline-light d-md-none mb-3">
                <i class="bi bi-list"></i>
            </button>
            <div class="brand mb-1">
                <img src="../src/Canva Scratch (3).png" class="rounded-circle" alt="Logo">
            </div>
            <nav class="nav flex-column w-100 text-center">
                <a href="../html/Dashboard.html" class="nav-link text-white" title="Home">
                    <img src="../src/Icons/home.png" alt="Home" class="nav-icon">
                    <div class="nav-text">Home</div>
                </a>

                <a class="nav-link text-white" title="Notifications" style="position:relative;">
                    <img src="../src/Icons/bell.png" alt="Notifications" class="nav-icon">
                    <span class="notification-badge"
                        style="display:none;position:absolute;top:6px;right:12px;background:#e53935;color:#fff;border-radius:50%;padding:2px 7px;font-size:0.85rem;font-weight:700;z-index:2;"></span>
                    <div class="nav-text">Notifications</div>
                </a>
                <a href="../html/Order.html" class="nav-link text-white" title="Orders">
                    <img src="../src/Icons/shopping-bag.png" alt="Sales" class="nav-icon">
                    <div class="nav-text">Orders</div>
                </a>
                <a href="../html/pos.html" class="nav-link text-white" title="POS">
                    <img src="../src/Icons/cashier-machine.png" alt="POS" class="nav-icon">
                    <div class="nav-text">POS</div>
                </a>
                <a href="../html/menu.html" class="nav-link text-white" title="Menu">
                    <img src="../src/Icons/menu (1).png" alt="Menu" class="nav-icon">
                    <div class="nav-text">Menu</div>
                </a>
                <a href="../html/Inventory.html" class="nav-link text-white" title="Inventory">
                    <img src="../src/Icons/inventory.png" alt="Inventory" class="nav-icon">
                    <div class="nav-text">Inventory</div>
                </a>
                <a href="../html/analytics.html" class="nav-link text-white" title="Reports">
                    <img src="../src/Icons/bars.png" alt="reports" class="nav-icon">
                    <div class="nav-text">Reports</div>
                </a>
                <a href="../html/user.html" class="nav-link text-white" title="Users">
                    <img src="../src/Icons/user.png" alt="user" class="nav-icon">
                    <div class="nav-text">Users</div>
                </a>
                <div style="flex-grow: 1;"></div>
                
                <a href="../html/Settings.html" class="nav-link text-white" title="Settings">
                    <img src="../src/Icons/setting.png" alt="Settings" class="nav-icon">
                    <div class="nav-text">Settings</div>
                </a>
                <a href="#" id="logoutBtn" class="nav-link text-white" title="Logout">
                    <img src="../src/Icons/log-out.png" alt="Logout" class="nav-icon">
                    <div class="nav-text">Logout</div>
                </a>
            </nav>
            <!-- Notification Dropdown UI (anchored to nav/sidebar) -->
            <div id="notificationDropdown" class="notification-dropdown"
                style="display:none;position:absolute;top:80px;left:120px;width:370px;background:#fff;border-radius:16px;box-shadow:0 4px 24px rgba(0,0,0,0.12);z-index:1000;">
                <div class="dropdown-header p-3 border-bottom d-flex align-items-center justify-content-between">
                    <img src="../src/Icons/bell.png" alt="Notifications"
                        style="width:32px;height:32px;object-fit:contain;filter:brightness(1.2);">
                    <span style="font-weight:600;font-size:1.1rem;margin-left:8px;">Notifications</span>
                    <img src="../src/Icons/close.png" id="closeDropdown" alt="Close"
                        style="width:24px;height:24px;cursor:pointer;filter:grayscale(1) brightness(0.6);">
                </div>
                <div class="dropdown-body p-2" id="dropdownNotificationsList">
                    <!-- Notifications will be loaded here dynamically -->
                    <div class="text-center text-muted py-3">No notifications</div>
                </div>
                <div class="dropdown-footer p-2 text-center border-top">
                    <a href="../html/notifi.html" class="see-all-link"
                        style="color:#4361EE;font-weight:600;text-decoration:none;">See all incoming activity</a>
                </div>
            </div>
        </aside>

        <main class="main-content flex-grow-1 p-4">
            <div class="account-container">
                <div class="account-content d-flex flex-column">
                    <h1 class="account-title">Account</h1>

                    <div class="account-body d-flex">
                        <!-- Left Panel - Profile -->
                        <div class="profile-panel">
                            <div class="profile-image-container">
                                <div class="profile-image" id="profileImageContainer">
                                    <img id="profileImg" src="" alt="Profile Picture">
                                    <div class="placeholder-icon" id="placeholderIcon">
                                        <i class="bi bi-person-circle"></i>
                                    </div>
                                    <div class="edit-icon" id="editProfileIcon">
                                        <i class="bi bi-pencil"></i>
                                    </div>
                                    <input type="file" id="profileImageInput" accept="image/*" style="display:none;">
                                </div>
                            </div>
                            <h3 class="profile-name">User</h3>
                            <p class="profile-role">Admin</p>

                            <div class="profile-menu">
                                <div class="menu-item active" id="personalInfoMenu">
                                    <i class="bi bi-person"></i>
                                    <span>Personal Information</span>
                                </div>
                                <div class="menu-item" id="loginPasswordMenu" style="cursor:pointer;">
                                    <i class="bi bi-lock"></i>
                                    <span>Login & Password</span>
                                </div>
                            </div>
                        </div>

                        <!-- Right Panel - Personal Information -->
                        <div class="info-panel flex-grow-1" id="personalInfoPanel">
                            <h2 class="info-title">Personal Information</h2>

                            <!-- Firebase Connection Status -->
                            <div id="connectionStatus" class="alert alert-info" style="display: none;">
                                <i class="bi bi-cloud"></i> Connecting to Firebase...
                            </div>

                            <form class="personal-info-form" id="userForm"
                                onsubmit="event.preventDefault(); return false;">
                                <!-- Gender Selection -->
                                <div class="gender-selection mb-4">
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="gender" id="male"
                                            value="male" checked>
                                        <label class="form-check-label" for="male">Male</label>
                                    </div>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="gender" id="female"
                                            value="female">
                                        <label class="form-check-label" for="female">Female</label>
                                    </div>
                                </div>

                                <!-- Name Fields -->
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="firstName" class="form-label">First Name</label>
                                        <input type="text" class="form-control" id="firstName"
                                            placeholder="Enter first name">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="lastName" class="form-label">Last Name</label>
                                        <input type="text" class="form-control" id="lastName"
                                            placeholder="Enter last name">
                                    </div>
                                </div>

                                <!-- Address -->
                                <div class="mb-3">
                                    <label for="address" class="form-label">Address</label>
                                    <input type="text" class="form-control" id="address" placeholder="Enter address">
                                </div>

                                <!-- Phone and Date of Birth -->
                                <div class="row mb-3">
                                    <div class="col-md-6">
                                        <label for="phone" class="form-label">Phone Number</label>
                                        <input type="tel" class="form-control" id="phone"
                                            placeholder="Enter phone number">
                                    </div>
                                    <div class="col-md-6">
                                        <label for="dob" class="form-label">Date of Birth</label>
                                        <div class="input-group">
                                            <input type="date" class="form-control" id="dob">
                                        </div>
                                    </div>
                                </div>


                                <!-- Action Buttons -->
                                <div class="d-flex justify-content-end mt-4">
                                    <button type="button" class="btn btn-secondary me-2" id="cancelEditBtn"
                                        onclick="cancelEdit()" style="display: none;">
                                        <i class="bi bi-x-circle me-2"></i>Cancel
                                    </button>
                                    <button type="button" class="btn btn-primary" id="saveUserData"
                                        onclick="toggleEditMode()">
                                        <i class="bi bi-pencil me-2"></i>Edit
                                    </button>
                                </div>
                            </form>
                        </div>

                        <!-- Right Panel - Login & Password -->
                        <div class="info-panel flex-grow-1" id="loginPasswordPanel" style="display: none;">
                            <h2 class="info-title">Login & Password</h2>

                            <!-- Firebase Connection Status -->
                            <div id="connectionStatus2" class="alert alert-info" style="display: none;">
                                <i class="bi bi-cloud"></i> Connecting to Firebase...
                            </div>

                            <form class="login-password-form" id="loginPasswordForm"
                                onsubmit="event.preventDefault(); return false;">
                                
                                <!-- Current Password -->
                                <div class="mb-3">
                                    <label for="currentPassword" class="form-label">Current Password</label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="currentPassword"
                                            placeholder="Enter current password" required>
                                        <button class="btn btn-outline-secondary" type="button" id="toggleCurrentPassword">
                                            <i class="bi bi-eye" id="currentPasswordIcon"></i>
                                        </button>
                                    </div>
                                    <div class="form-text" id="currentPasswordStatus" style="display: none;">
                                        <i class="bi bi-check-circle text-success me-1"></i>
                                        <span class="text-success">Current password verified</span>
                                    </div>
                                </div>

                                <!-- New Password -->
                                <div class="mb-3">
                                    <label for="newPassword" class="form-label">New Password</label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="newPassword"
                                            placeholder="Enter new password" required disabled>
                                        <button class="btn btn-outline-secondary" type="button" id="toggleNewPassword" disabled>
                                            <i class="bi bi-eye" id="newPasswordIcon"></i>
                                        </button>
                                    </div>
                                    <div class="form-text">
                                        Password must be at least 6 characters long.
                                    </div>
                                </div>

                                <!-- Confirm New Password -->
                                <div class="mb-3">
                                    <label for="confirmPassword" class="form-label">Confirm New Password</label>
                                    <div class="input-group">
                                        <input type="password" class="form-control" id="confirmPassword"
                                            placeholder="Confirm new password" required disabled>
                                        <button class="btn btn-outline-secondary" type="button" id="toggleConfirmPassword" disabled>
                                            <i class="bi bi-eye" id="confirmPasswordIcon"></i>
                                        </button>
                                    </div>
                                </div>

                                <!-- Password Strength Indicator -->
                                <div class="mb-3">
                                    <div class="password-strength" id="passwordStrength" style="display: none;">
                                        <div class="strength-bar">
                                            <div class="strength-fill" id="strengthFill"></div>
                                        </div>
                                        <div class="strength-text" id="strengthText"></div>
                                    </div>
                                </div>

                                <!-- Save Button -->
                                <div class="d-flex justify-content-end mt-4">
                                    <button type="button" class="btn btn-primary" id="savePasswordData"
                                        onclick="handlePasswordSaveClick()" disabled>
                                        <i class="bi bi-check-circle me-2"></i>Update Password
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>



    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="../main.js"></script>


    <!-- Other scripts -->
    <script src="../javascript/navnotifi.js"></script>
    <script src="../javascript/notifications.js"></script>
    <script src="../cloud.js"></script>
    <script src="../javascript/form-validation.js"></script>
    <script src="../javascript/user.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Additional page-specific initialization if needed
        console.log('User page loaded with external JavaScript file');
    </script>
</body>

</html>