<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Notifications</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="../css/nav.css">
    <link rel="stylesheet" href="../css/styleNotification.css">
    <link rel="icon" type="image/png" href="/src/IMG/NF.png">
</head>

<body>
    <div class="dashboard-container d-flex">
        <aside id="sidebar" class="sidebar d-flex flex-column align-items-center py-3">
            <button id="burgerBtn" class="btn btn-outline-light d-md-none mb-3">
                <i class="bi bi-list"></i>
            </button>
            <div class="brand mb-1">
                <img src="../src/Canva Scratch (3).png" class="rounded-circle" alt="Logo">
            </div>
            <nav class="nav flex-column w-100 text-center">
                <a href="../html/Dashboard.html" class="nav-link text-white" title="Home" id="homeNavLink">
                    <img src="../src/Icons/home.png" alt="Home" class="nav-icon">
                    <div class="nav-text">Home</div>
                </a>
                <a href="../html/notifi.html" class="nav-link text-white active" title="Notifications"
                    style="position:relative;">
                    <img src="../src/Icons/bell.png" alt="Notifications" class="nav-icon">
                    <span class="notification-badge"
                        style="display:none;position:absolute;top:8px;right:18px;background:#e53935;color:#fff;border-radius:50%;padding:2px 7px;font-size:0.85rem;font-weight:700;z-index:2;"></span>
                    <div class="nav-text">Notifications</div>
                </a>
                <a href="../html/Order.html" class="nav-link text-white" title="Orders">
                    <img src="../src/Icons/shopping-bag.png" alt="Sales" class="nav-icon">
                    <div class="nav-text">Orders</div>
                </a>
                <a href="../html/pos.html" class="nav-link text-white" title="POS">
                    <img src="../src/Icons/cashier-machine.png" alt="POS" class="nav-icon">
                    <div class="nav-text">POS</div>
                </a>
                <a href="../html/menu.html" class="nav-link text-white" title="Menu">
                    <img src="../src/Icons/menu (1).png" alt="Menu" class="nav-icon">
                    <div class="nav-text">Menu</div>
                </a>
                <a href="../html/Inventory.html" class="nav-link text-white" title="Inventory">
                    <img src="../src/Icons/inventory.png" alt="Inventory" class="nav-icon">
                    <div class="nav-text">Inventory</div>
                </a>
                <a href="../html/analytics.html" class="nav-link text-white" title="Reports">
                    <img src="../src/Icons/bars.png" alt="reports" class="nav-icon">
                    <div class="nav-text">Reports</div>
                </a>
                <!-- Users nav removed -->

                <div style="flex-grow: 1;"></div>

                <a href="../html/Settings.html" class="nav-link text-white" title="Settings">
                    <img src="../src/Icons/setting.png" alt="Settings" class="nav-icon">
                    <div class="nav-text">Settings</div>
                </a>
                <a href="#" id="logoutBtn" class="nav-link text-white" title="Logout">
                    <img src="../src/Icons/log-out.png" alt="Logout" class="nav-icon">
                    <div class="nav-text">Logout</div>
                </a>
            </nav>
        </aside>
        <main class="main-content flex-grow-1 p-4">
            <div class="header-action-row d-flex justify-content-between align-items-center mb-4">
                <div class="inventory-header">
                    <h1 class="inventory-title">Notifications</h1>
                    <p class="inventory-subtitle">Recent system and order alerts</p>
                </div>
            </div>
            <div class="inventory-table-container">
                <table class="table inventory-table">
                    <thead>
                        <tr>
                            <th style="width: 15%;">Type</th>
                            <th style="width: 65%;">Message</th>
                            <th style="width: 20%;">Time</th>
                        </tr>
                    </thead>
                    <tbody id="notificationStatus">
                        <!-- Notifications will be dynamically loaded here. User/person icons removed by CSS and not rendered in JS. -->
                    </tbody>
                </table>
            </div>
        </main>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="../javascript/notifications.js"></script>
    <script src="../main.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.7/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Auto-refresh notifications every 30 seconds for real-time updates
        document.addEventListener('DOMContentLoaded', function () {
            // Skip auto-refresh if this is an OMR page
            if (window.location.pathname.includes('OMR') || window.location.pathname.includes('omr')) {
                return;
            }

            // Setup kitchen role access control
            setupKitchenNotificationsAccess();

            loadNotifications();
            setInterval(loadNotifications, 30000);

            // Logout functionality
            const logoutBtn = document.getElementById('logoutBtn');
            if (logoutBtn) {
                logoutBtn.addEventListener('click', handleLogout);
            }
        });

        // Logout functionality
        function handleLogout() {
            firebase.auth().signOut().then(() => {
                console.log('User signed out successfully');
                window.location.href = '../index.html';
            }).catch((error) => {
                console.error('Error signing out:', error);
                window.location.href = '../index.html';
            });
        }
    </script>
</body>

</html>